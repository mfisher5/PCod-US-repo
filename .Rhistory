library(adegenet)
library(hierfstat)
setwd("D:/Pacific cod/DataAnalysis/PCod-US-repo/analyses")
my_data <-read.genepop("../stacks_wgenome/batch_1.filteredIndivids.filteredMAF_filteredLoci20p.gen", ncode = 2)
(summary(my_data))
my_data$pop
my_ind <- ind.count(my_data)
my_stats <- basic.stats(my_data)
#Get Observed heterozygosities per locus and pop
my_stats$Ho
my_stats$Hs
basic.stats(my_data)$n.ind.samp
write.table(my_stats$Hs, "USpcod_Hs.txt", sep="\t")
write.table(my_stats$Fis, "USpcod_Fis.txt", sep="\t")
write.table(basic.stats(my_data)$n.ind.samp, "Genotype_counts.txt", sep="\t")
setwd("D:/Pacific cod/DataAnalysis/PCod-US-repo/analyses")
# Load all necessary R packages
library(ape)
library(adegenet)
library(ade4)
library(doParallel)
library(diveRsity)
library(genetics)
library(hierfstat)
library(httpuv)
library(foreach)
library(iterators)
library(sendplot)
library(xlsx)
library(pegas)
library(plotrix)
library(ape)
library(ade4)
library(adegenet)
library(diveRsity)
library(doParallel)
library(foreach)
library(genetics)
library(hierfstat)
library(httpuv)
library(iterators)
library(sendplot)
library(xlsx)
library(pegas)
library(plotrix)
USpcod <-read.genepop("../stacks_wgenome/batch_1.filteredindivids.filtered_MAF_filteredLoci20p.gen")
setwd("D:/Pacific cod/DataAnalysis/PCod-US-repo")
USpcod <-read.genepop("stacks_wgenome/batch_1.filteredIndivids.filtered_MAF_filteredLoci20p.gen")
USpcod <-read.genepop("stacks_wgenome/batch_1.filteredIndivids.filteredMAF_filteredLoci20p.gen")
summary(USpcod)
pop_groups <- as.factor(c(rep("KOD03",41),rep("AD06",31),rep("WC05",33),rep("HS04",40),rep("PS12",41),rep("GS13",12), rep("PWS12",24), rep("UP03", 42)))
pop_labels <- c("Kodiak03", "Adak06", "WashCoast05", "HecateStrait04", "PugetSound12", "StraitofGeorgia13", "PWSound12", "UnimakPass03")
pop_cols <- c("aquamarine4","deepskyblue","darkorchid1","sienna2","chocolate1","darkgoldenrod", "deeppink4", "cyan")
dapc_all <- dapc(USpcod,USpcod$pop,n.pca=465,n.da=8) ##Retain all, then identify optimal number by optim.a.score
test_a_score <- optim.a.score(dapc_all)
dapc_all <- dapc(USpcod,USpcod$pop,n.pca=25,n.da=8) ##21 PC's is the optimal number
legend(x = -4, y = 5,bty='n', legend = pop_labels,pch=c(19),col=pop_cols,cex=1.1)
scatter(dapc_all,scree.da=FALSE,cellipse=0,leg=FALSE,label=c("KOD03","AD06","WC05","HS04","PS12","GS13", "PWS12","UP03"), posi.da="bottomleft",csub=2,col=pop_cols,cex=1.5,clabel=1,pch=c(19),solid=1)
legend(x = -4, y = 5,bty='n', legend = pop_labels,pch=c(19),col=pop_cols,cex=1.1)
legend("bottomleft",bty='n', legend = pop_labels,pch=c(19),col=pop_cols,cex=1.1)
legend("x = -10, y = 5"bo,bty='n', legend = pop_labels,pch=c(19),col=pop_cols,cex=1.1)
legend("x = -4, y = 5"bo,bty='n', legend = pop_labels,pch=c(19),col=pop_cols,cex=1.1)
legend(x = -4, y = 5, bo,bty='n', legend = pop_labels,pch=c(19),col=pop_cols,cex=1.1)
legend(x = -4, y = 5,bty='n', legend = pop_labels,pch=c(19),col=pop_cols,cex=1.1)
legend(x = -5, y = 5,bty='n', legend = pop_labels,pch=c(19),col=pop_cols,cex=1.1)
legend(x = -7, y = 5,bty='n', legend = pop_labels,pch=c(19),col=pop_cols,cex=1.1)
legend(x = -7, y = 2,bty='n', legend = pop_labels,pch=c(19),col=pop_cols,cex=1.1)
legend(x = -7, y = -2,bty='n', legend = pop_labels,pch=c(19),col=pop_cols,cex=1.1)
legend(x = -7, y = -3,bty='n', legend = pop_labels,pch=c(19),col=pop_cols,cex=1.1)
scatter(dapc_all,scree.da=FALSE,cellipse=0,leg=FALSE,label=c("KOD03","AD06","WC05","HS04","PS12","GS13", "PWS12","UP03"), posi.da="bottomleft",csub=2,col=pop_cols,cex=1.5,clabel=1,pch=c(19),solid=1)
legend(x = -7, y = -3,bty='n', legend = pop_labels,pch=c(19),col=pop_cols,cex=1.1)
legend(x = -8, y = -3,bty='n', legend = pop_labels,pch=c(19),col=pop_cols,cex=1.1)
legend(x = -8, y = -3,bty='n', legend = pop_labels,pch=c(19),col=pop_cols,cex=0.5)
legend(x = -7, y = -3,bty='n', legend = pop_labels,pch=c(19),col=pop_cols,cex=0.6)
legend(x = -7, y = -3,bty='n', legend = pop_labels,pch=c(19),col=pop_cols,cex=0.8)
scatter(dapc_all,scree.da=FALSE,cellipse=0,leg=FALSE,label=c("KOD03","AD06","WC05","HS04","PS12","GS13", "PWS12","UP03"), posi.da="bottomleft",csub=2,col=pop_cols,cex=1.5,clabel=1,pch=c(19),solid=1)
legend(x = -7, y = -3,bty='n', legend = pop_labels,pch=c(19),col=pop_cols,cex=0.8)
legend(x = -7, y = -4,bty='n', legend = pop_labels,pch=c(19),col=pop_cols,cex=0.8)
scatter(dapc_all,scree.da=FALSE,cellipse=0,leg=FALSE,label=c("KOD03","AD06","WC05","HS04","PS12","GS13", "PWS12","UP03"), posi.da="bottomleft",csub=2,col=pop_cols,cex=1.5,clabel=1,pch=c(19),solid=1)
legend(x = -7, y = -3.5,bty='n', legend = pop_labels,pch=c(19),col=pop_cols,cex=0.8)
pop_cols <- c("aquamarine4","deepskyblue","darkorchid1","sienna2","chocolate1","chartreuse", "deeppink4", "cyan")
scatter(dapc_all,scree.da=FALSE,cellipse=0,leg=FALSE,label=c("KOD03","AD06","WC05","HS04","PS12","GS13", "PWS12","UP03"), posi.da="bottomleft",csub=2,col=pop_cols,cex=1.5,clabel=1,pch=c(19),solid=1)
pop_cols <- c("aquamarine4","deepskyblue","darkorchid1","sienna2","chartreuse","darkgoldenrod", "deeppink4", "cyan")
scatter(dapc_all,scree.da=FALSE,cellipse=0,leg=FALSE,label=c("KOD03","AD06","WC05","HS04","PS12","GS13", "PWS12","UP03"), posi.da="bottomleft",csub=2,col=pop_cols,cex=1.5,clabel=1,pch=c(19),solid=1)
legend(x = -7, y = -3.5,bty='n', legend = pop_labels,pch=c(19),col=pop_cols,cex=0.8)
