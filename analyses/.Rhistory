batch_1.CorrectedGenotypes_biallelic <- read.delim("D:/Pacific cod/DataAnalysis/PCod-US-repo/stacks_wgenome/batch_1.CorrectedGenotypes_biallelic.txt")
View(batch_1.CorrectedGenotypes_biallelic)
genepop <- batch_1.CorrectedGenotypes_biallelic
ncol(genepop)
?seq
seq(from = 2, to = ncol(genepop)
)
genotypes <- genepop[,2]
head(genotypes)
missing_counts <- c()
for(i in seq(from = 2, to = 5)) {
genotypes <- genepop[,i]
n_missing <- which(genotypes == "-")
missing_counts <- c(missing_counts, n_missing)
}
hist(missing_counts)
genepop <- batch_1.CorrectedGenotypes_biallelic
total_loci <- ncol(genepop)
missing_props <- c()
for(i in seq(from = 2, to = 5)) {
genotypes <- genepop[,i]
p_missing <- (which(genotypes == "-"))/total_loci
missing_props <- c(missing_props, p_missing)
}
hist(missing_counts)
hist(missing_props)
for(i in seq(from = 2, to = ncol(genepop))) {
genotypes <- genepop[,i]
p_missing <- (which(genotypes == "-"))/total_loci
missing_props <- c(missing_props, p_missing)
}
hist(missing_props)
total_loci
total_loci <- ncol(genepop) - 2
48*9
1/9
genepop[,2]
genotypes <- genepop[,2]
length(genotypes)
which(genotypes == "-") / length(genotypes)
which(genotypes == "-")
length(which(genotypes == "-"))
length(which(genotypes == "-")) / total_loci
for(i in seq(from = 2, to = ncol(genepop)-1)) {
genotypes <- genepop[,i]
p_missing <- (length(which(genotypes == "-")))/total_loci
missing_props <- c(missing_props, p_missing)
}
hist(missing_props)
hist(missing_props)
total_loci <- ncol(genepop) - 2
missing_props <- c()
for(i in seq(from = 2, to = ncol(genepop)-1)) {
genotypes <- genepop[,i]
p_missing <- (length(which(genotypes == "-")))/total_loci
missing_props <- c(missing_props, p_missing)
}
hist(missing_props)
total_individs <- nrow(genepop) - 2
total_individs
total_individs <- nrow(genepop)
total_individs <- nrow(genepop)
total_individs
total_loci
missing_props2 <- c()
total_individs <- nrow(genepop)
for(i in seq(from = 2, to = nrow(genepop)-1)) {
genotypes <- genepop[i,]
p_missing <- (length(which(genotypes == "-")))/total_individs
missing_props2 <- c(missing_props2, p_missing)
}
genotypes <- genepop[2,]
head(genotypes)
length(which(genotypes=="-"))
missing_props2 <- c()
total_individs <- nrow(genepop)
for(i in seq(from = 1, to = total_individs)) {
genotypes <- genepop[i,]
p_missing <- (length(which(genotypes == "-")))/total_individs
missing_props2 <- c(missing_props2, p_missing)
}
hist(missing_props2)
title(main = "Missing Data per Individual", ylab = "Proportion Missing Genotypes")
hist(missing_props2)
missing_props2 <- c()
total_individs <- nrow(genepop)
for(i in seq(from = 1, to = total_individs)) {
genotypes <- genepop[i,]
p_missing <- (length(which(genotypes == "-")))/total_loci
missing_props2 <- c(missing_props2, p_missing)
}
hist(missing_props2)
total_loci <- ncol(genepop) - 2
total_individs <- nrow(genepop)
missing_props <- c()
#-- missing data per locus
for(i in seq(from = 2, to = ncol(genepop)-1)) {
genotypes <- genepop[,i]
p_missing <- (length(which(genotypes == "-")))/total_individs
missing_props <- c(missing_props, p_missing)
}
hist(missing_props)
missing_props2 <- c()
total_individs <- nrow(genepop)
for(i in seq(from = 1, to = total_individs)) {
genotypes <- genepop[i,]
p_missing <- (length(which(genotypes == "-")))/total_loci
missing_props2 <- c(missing_props2, p_missing)
}
hist(missing_props2)
length(missing_pops2 > 0.5)
length(which(missing_pops2 > 0.5))
length(which(missing_props2 > 0.5))
length(which(missing_props > 0.5))
?hist
length(missing_props)
length(missing_props2)
hist(missing_props, main = "Missing Data per Locus", ylab = "Proportion Missing Genotypes")
hist(missing_props, main = "Missing Data per Locus", xlab = "Proportion Individuals Missing Genotypes")
hist(missing_props2, main = "Missing Data per Individual", xlab = "Proportion Loci Missing Genotypes")
gte_90 <- which(missing_props2 >= 0.90)
length(gte_90)
gte_90
gte_90_indices <- which(missing_props2 >= 0.90)
length(gte_90)
loci_indices <- seq(2, total_loci)
loci_indices[!loci_indices==gte_90_indices]
for(i in gte_90_indices){
loci_indices[!loci_indices==i]
}
gte_90_indices
which(loci_indices == 193)
for(i in gte_90_indices){
trunc_loci_indices <- loci_indices[!loci_indices==i]
}
which(trunc_loci_indices == 193)
loci_list[!loci_list %in% gte_90_indices]
loci_indices[!loci_indices %in% gte_90_indices]
gte_90_indices
which(loci_indices == 193)
which(loci_indices == "193")
trunc_loci_indices <- loci_indices[!loci_indices %in% gte_90_indices]
which(trunc_loci_indices == "193")
missing_props_lte90 <- c()
for(i in trunc_loci_indices){
genotypes <- genepop[,i]
p_missing <- (length(which(genotypes == "-")))/total_individs
missing_props_lte90 <- c(missing_props_lte90, p_missing)
}
hist(missing_props_lte90, main = "Missing Data per Locus", xlab = "Proportion Loci Missing Genotypes")
length(missing_props_lte90)
5864-length(gte_90_indices)
hist(missing_props_lte90, main = "Missing Data per Locus (Individuals <90% Missing Genotypes", xlab = "Proportion Individuals Missing Genotypes")
hist(missing_props_lte90, main = "Missing Data per Locus (Individs <90% MD)", xlab = "Proportion Individuals Missing Genotypes")
gte_50_indices <- which(missing_props2 >= 0.50) #which individuals are missing more than 90% of data
length(gte_50_indices)
gte_50_indices <- which(missing_props2 >= 0.90) #which individuals are missing more than 90% of data
length(gte_90_indices)
gte_50_indices <- which(missing_props2 >= 0.50) #which individuals are missing more than 90% of data
length(gte_50_indices)
loci_indices <- seq(2,total_loci) #create a list of loci indices
trunc_loci_indices <- loci_indices[!loci_indices %in% gte_50_indices] #remove those individuals from the list of loci indices
missing_props_lte50 <- c()
for(i in trunc_loci_indices){
genotypes <- genepop[,i]
p_missing <- (length(which(genotypes == "-")))/total_individs
missing_props_lte50 <- c(missing_props_lte50, p_missing)
}
hist(missing_props_lte50, main = "Missing Data per Locus (Individs <50% MD)", xlab = "Proportion Individuals Missing Genotypes")
length(missing_props_lte50)
gte_20_indices <- which(missing_props2 >= 0.20) #which individuals are missing more than 90% of data
length(gte_20_indices)
loci_indices <- seq(2,total_loci) #create a list of loci indices
trunc_loci_indices <- loci_indices[!loci_indices %in% gte_20_indices] #remove those individuals from the list of loci indices
missing_props_lte20 <- c()
for(i in trunc_loci_indices){
genotypes <- genepop[,i]
p_missing <- (length(which(genotypes == "-")))/total_individs
missing_props_lte20 <- c(missing_props_lte20, p_missing)
}
hist(missing_props_lte20, main = "Missing Data per Locus (Individs <20% MD)", xlab = "Proportion Individuals Missing Genotypes")
length(missing_props_lte20)
gte_90_indices <- which(missing_props2 >= 0.90) #which individuals are missing more than 90% of data
n_individs <- total_individs- length(gte_90_indices) # new total number of individuals
n_individs
missing_props_lte90 <- c()
for(i in loci_indices){
genotypes <- genepop[,i]
genotypes_indices <- seq(1,length(genotypes))
trunc_genotypes_indices <- genotypes_indices[!genotypes_indices %in% gte_20_indices]
new_genotypes <- c()
for(i in trunc_genotypes_indices){
new_genotypes <- c(new_genotypes, genotypes[i])
}
p_missing <- (length(which(new_genotypes == "-")))/n_individs
missing_props_lte90 <- c(missing_props_lte90, p_missing)
}
hist(missing_props_lte90, main = "Missing Data per Locus (Individs <90% MD)", xlab = "Proportion Individuals Missing Genotypes")
missing_props_lte90
genotypes <- genepop[,2]
genotypes_indices <- seq(1,length(genotypes))
genotypes_indices
trunc_genotypes_indices <- genotypes_indices[!genotypes_indices %in% gte_20_indices]
trunc_genotypes_indices
new_genotypes <- c()
for(i in trunc_genotypes_indices){
new_genotypes <- c(new_genotypes, genotypes[i])
}
new_genotypes
genotypes_indices
genotypes
genotype[1]
genotypes[1]
new_genotypes <- c(genotypes[1])
new_genotypes
genotypes <- genepop[,2]
genotypes <- genotypes[-gte_90_indices]
genotypes
length(genotypes)
length(gte_90_indices)
p_missing <- (length(which(new_genotypes == "-")))/n_individs
p_missing
n_individs <- total_individs- length(gte_90_indices) # new total number of individuals
loci_indices <- seq(2,total_loci) #create a list of loci indices
missing_props_lte90 <- c()
for(i in loci_indices){
genotypes <- genepop[,i]
new_genotypes <- genotypes[-gte_90_indices]
p_missing <- (length(which(new_genotypes == "-")))/n_individs
missing_props_lte90 <- c(missing_props_lte90, p_missing)
}
hist(missing_props_lte90, main = "Missing Data per Locus (Individs <90% MD)", xlab = "Proportion Individuals Missing Genotypes")
length(missing_props_lte90)/total_loci
length(which(missing_props2 <= 0.20))
total_individs
265/377
gte_90_indices <- which(missing_props2 >= 0.80) #which individuals are missing more than 90% of data
n_individs <- total_individs- length(gte_90_indices) # new total number of individuals
loci_indices <- seq(2,total_loci) #create a list of loci indices
missing_props_lte90 <- c()
for(i in loci_indices){
genotypes <- genepop[,i]
new_genotypes <- genotypes[-gte_90_indices] #remove the genotypes that belong to the individuals missing > 90% of their data
p_missing <- (length(which(new_genotypes == "-")))/n_individs
missing_props_lte90 <- c(missing_props_lte90, p_missing)
}
hist(missing_props_lte90, main = "Missing Data per Locus (Individs <80% MD)", xlab = "Proportion Individuals Missing Genotypes")
length(missing_props_lte20)
missing_props_lte90
n_individs
gte_90_indices <- which(missing_props2 <= 0.20) #which individuals are missing more than 90% of data
n_individs <- total_individs- length(gte_90_indices) # new total number of individuals
loci_indices <- seq(2,total_loci) #create a list of loci indices
missing_props_lte90 <- c()
for(i in loci_indices){
genotypes <- genepop[,i]
new_genotypes <- genotypes[-gte_90_indices] #remove the genotypes that belong to the individuals missing > 90% of their data
p_missing <- (length(which(new_genotypes == "-")))/n_individs
missing_props_lte90 <- c(missing_props_lte90, p_missing)
}
hist(missing_props_lte90, main = "Missing Data per Locus (Individs <20% MD)", xlab = "Proportion Individuals Missing Genotypes")
length(missing_props_lte20)
missing_props_lte90
gte_90_indices <- which(missing_props2 >= 0.20) #which individuals are missing more than 90% of data
n_individs <- total_individs- length(gte_90_indices) # new total number of individuals
loci_indices <- seq(2,total_loci) #create a list of loci indices
missing_props_lte90 <- c()
for(i in loci_indices){
genotypes <- genepop[,i]
new_genotypes <- genotypes[-gte_90_indices] #remove the genotypes that belong to the individuals missing > 90% of their data
p_missing <- (length(which(new_genotypes == "-")))/n_individs
missing_props_lte90 <- c(missing_props_lte90, p_missing)
}
hist(missing_props_lte90, main = "Missing Data per Locus (Individs <20% MD)", xlab = "Proportion Individuals Missing Genotypes")
length(missing_props_lte20)
missing_props_lte90
length(which(missing_props_lte90 <= 0.2))
genotypes
genotypes <- genepop[1,]
genotypes
genotypes[1]
total_individs <- nrow(genepop)
for(i in seq(from = 1, to = total_individs)) {
genotypes <- genepop[i,]
p_missing <- (length(which(genotypes == "-")))/total_loci
if(p_missing > 0.20){
print genotypes[1]
}
missing_props2 <- c(missing_props2, p_missing)
}
total_individs <- nrow(genepop)
remove_individs <- c()
for(i in seq(from = 1, to = total_individs)) {
genotypes <- genepop[i,]
p_missing <- (length(which(genotypes == "-")))/total_loci
if(p_missing > 0.20){
remove_individs <- c(remove_individs,genotypes[1])
}
missing_props2 <- c(missing_props2, p_missing)
}
print remove_individs
print(remove_individs)
length(remove_individs)
as.vector(remove_individs)
levels(remove_individs)
Levels(remove_individs)
length(which(missing_props > 0.5))
length(which(missing_props > 0.2))
length(which(missing_props2 > 0.2))
length(which(missing_props2 <= 0.20))
length(which(missing_props_lte90 <= 0.2))
length(which(missing_props_lte90 > 0.2))
print(remove_individs)
length(remove_individs)
gte_90_indices <- which(missing_props2 >= 0.90) #which individuals are missing more than 90% of data
n_individs <- total_individs- length(gte_90_indices) # new total number of individuals
loci_indices <- seq(2,total_loci) #create a list of loci indices
missing_props_lte90 <- c()
for(i in loci_indices){
genotypes <- genepop[,i]
new_genotypes <- genotypes[-gte_90_indices] #remove the genotypes that belong to the individuals missing > 90% of their data
p_missing <- (length(which(new_genotypes == "-")))/n_individs
}
missing_props_lte90 <- c(missing_props_lte90, p_missing)
}
gte_90_indices <- which(missing_props2 >= 0.90) #which individuals are missing more than 90% of data
n_individs <- total_individs- length(gte_90_indices) # new total number of individuals
loci_indices <- seq(2,total_loci) #create a list of loci indices
missing_props_lte90 <- c()
for(i in loci_indices){
genotypes <- genepop[,i]
new_genotypes <- genotypes[-gte_90_indices] #remove the genotypes that belong to the individuals missing > 90% of their data
p_missing <- (length(which(new_genotypes == "-")))/n_individs
missing_props_lte90 <- c(missing_props_lte90, p_missing)
}
length(which(missing_props_lte90 > 0.2))
gte_90_indices <- which(missing_props2 >= 0.80) #which individuals are missing more than 90% of data
n_individs <- total_individs- length(gte_90_indices) # new total number of individuals
loci_indices <- seq(2,total_loci) #create a list of loci indices
missing_props_lte90 <- c()
for(i in loci_indices){
genotypes <- genepop[,i]
new_genotypes <- genotypes[-gte_90_indices] #remove the genotypes that belong to the individuals missing > 90% of their data
p_missing <- (length(which(new_genotypes == "-")))/n_individs
missing_props_lte90 <- c(missing_props_lte90, p_missing)
}
length(which(missing_props_lte90 > 0.2))
gte_90_indices <- which(missing_props2 >= 0.20) #which individuals are missing more than 90% of data
n_individs <- total_individs- length(gte_90_indices) # new total number of individuals
loci_indices <- seq(2,total_loci) #create a list of loci indices
missing_props_lte90 <- c()
for(i in loci_indices){
genotypes <- genepop[,i]
new_genotypes <- genotypes[-gte_90_indices] #remove the genotypes that belong to the individuals missing > 90% of their data
p_missing <- (length(which(new_genotypes == "-")))/n_individs
missing_props_lte90 <- c(missing_props_lte90, p_missing)
}
length(which(missing_props_lte90 > 0.2))
hist(missing_props_lte90, main = "Missing Data per Locus (Individs <20% MD)", xlab = "Proportion Individuals Missing Genotypes")
length(missing_props_lte20)
gte_90_indices <- which(missing_props2 >= 0.90) #which individuals are missing more than 90% of data
n_individs <- total_individs- length(gte_90_indices) # new total number of individuals
loci_indices <- seq(2,total_loci) #create a list of loci indices
missing_props_lte90 <- c()
for(i in loci_indices){
genotypes <- genepop[,i]
new_genotypes <- genotypes[-gte_90_indices] #remove the genotypes that belong to the individuals missing > 90% of their data
p_missing <- (length(which(new_genotypes == "-")))/n_individs
missing_props_lte90 <- c(missing_props_lte90, p_missing)
}
length(which(missing_props_lte90 > 0.2))
hist(missing_props_lte90, main = "Missing Data per Locus (Individs <20% MD)", xlab = "Proportion Individuals Missing Genotypes")
gte_90_indices <- which(missing_props2 >= 0.90) #which individuals are missing more than 90% of data
n_individs <- total_individs- length(gte_90_indices) # new total number of individuals
length(gte_90_indices)
n_individs
total_individs
missing_props2 <- c()
total_individs <- nrow(genepop)
for(i in seq(from = 1, to = total_individs)) {
genotypes <- genepop[i,]
p_missing <- (length(which(genotypes == "-")))/total_loci
missing_props2 <- c(missing_props2, p_missing)
}
hist(missing_props2, main = "Missing Data per Individual", xlab = "Proportion Loci Missing Genotypes")
length(which(missing_props2 > 0.2))
length(missing_props2)
gte_90_indices <- which(missing_props2 >= 0.90) #which individuals are missing more than 90% of data
n_individs <- total_individs- length(gte_90_indices) # new total number of individuals
loci_indices <- seq(2,total_loci) #create a list of loci indices
missing_props_lte90 <- c()
for(i in loci_indices){
genotypes <- genepop[,i]
new_genotypes <- genotypes[-gte_90_indices] #remove the genotypes that belong to the individuals missing > 90% of their data
p_missing <- (length(which(new_genotypes == "-")))/n_individs
missing_props_lte90 <- c(missing_props_lte90, p_missing)
}
length(which(missing_props_lte90 > 0.2))
hist(missing_props_lte90, main = "Missing Data per Locus (Individs <20% MD)", xlab = "Proportion Individuals Missing Genotypes")
length(missing_props_lte90)
length(gte_90_indices)
gte_90_indices <- which(missing_props2 >= 0.80) #which individuals are missing more than 90% of data
length(gte_90_indices)
n_individs <- total_individs- length(gte_90_indices) # new total number of individuals
loci_indices <- seq(2,total_loci) #create a list of loci indices
missing_props_lte90 <- c()
for(i in loci_indices){
genotypes <- genepop[,i]
new_genotypes <- genotypes[-gte_90_indices] #remove the genotypes that belong to the individuals missing > 90% of their data
p_missing <- (length(which(new_genotypes == "-")))/n_individs
missing_props_lte90 <- c(missing_props_lte90, p_missing)
}
length(which(missing_props_lte90 > 0.2))
length(missing_props_lte90)
gte_90_indices <- which(missing_props2 >= 0.20) #which individuals are missing more than 90% of data
length(gte_90_indices)
total_individs <- nrow(genepop)
total_individs
total_individs-113
